#!/usr/bin/bash
#
# Functions to manage my Advent of Code 2021 projects

# Add a package. Pass the name of the new package.
add_package() {
    package=$1
    cargo init ${package}
    update_toml
}

# Update Cargo.toml with the current packages
update_toml() {
    rm -rf "Cargo.toml"
    {
        echo "# This file is generated by 'run'. Change it there if you need to."
        echo ""
        echo "[workspace]"
        echo "members = ["
        for package in */; do
            count=$(ls -1 "${package}/Cargo.toml" 2>/dev/null | wc -l)
            if [ $count != 0 ]; then
                echo "  \"${package}\","
            fi
        done
        echo "]"
    } >Cargo.toml
}
